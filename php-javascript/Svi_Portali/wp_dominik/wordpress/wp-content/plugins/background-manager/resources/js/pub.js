/*!
 * Copyright (c) 2011-2012 Mike Green <myatus@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 *
 */
if(typeof myatu_bgm==="undefined"){var myatu_bgm={}}(function(d){var e=["Width","Height"],f;while(f=e.pop()){(function(b,a){d.fn[b]=(b in new Image())?function(){return this[0][b]}:function(){var i=this[0],j,c;if(i.tagName.toLowerCase()==="img"){j=new Image();j.src=i.src,c=j[a]}return c}}("natural"+f,f.toLowerCase()))}}(jQuery));(function(b){b.extend(myatu_bgm,{previous_background:{},flux_transitions:["bars","zip","blinds","swipe","blocks","blocks2","concentric","warp"],image_holder:null,setTimer:function(){if(myatu_bgm.change_freq<=0){return}if(myatu_bgm.timer){clearTimeout(myatu_bgm.timer)}myatu_bgm.timer=setTimeout(myatu_bgm.switchBackground,myatu_bgm.change_freq*1000)},doGAEvent:function(e,a){var f=myatu_bgm.bg_track_clicks_category;if(typeof e==="undefined"){return}if(typeof a==="undefined"){a=myatu_bgm.current_background.bg_link}if(!f){f="Background Manager"}if(a&&myatu_bgm.bg_track_clicks==="true"&&typeof _gaq!=="undefined"&&b.isFunction(_gaq.push)){_gaq.push(["_trackEvent",f,e,a])}},onBackgroundClick:function(e){var f=myatu_bgm.current_background.bg_link,a;if(e.target===this||b(e.target).hasClass("myatu_bgm_fs")){b(document).trigger("myatu_bgm_background_click",[f]);myatu_bgm.doGAEvent("Click");if(myatu_bgm.bg_click_new_window==="true"){window.open(f)}else{setTimeout(function(){window.location.assign(f)},500)}return false}},onBackgroundHover:function(a){b(this).css("cursor",(a.target===this||b(a.target).hasClass("myatu_bgm_fs"))?"pointer":"auto")},setBackgroundLink:function(){var a=b("body");a.unbind("click",myatu_bgm.onBackgroundClick).unbind("mouseover",myatu_bgm.onBackgroundHover).css("cursor","auto");if(myatu_bgm.current_background.bg_link!==""&&myatu_bgm.current_background.bg_link!=="#"){a.bind("click",myatu_bgm.onBackgroundClick).bind("mouseover",myatu_bgm.onBackgroundHover)}},urlReplaceQueryArgVal:function(g,f,a){var h=new RegExp("(?![?&])"+f+"=(.*?(?=\\?|\\&(?!amp;)|#|$))","ig");return g.replace(h,f+"="+encodeURIComponent(a))},onAnimationCompleted:function(){b("#myatu_bgm_prev").remove();myatu_bgm.setTimer();b(document).trigger("myatu_bgm_finish_transition")},animateSlide:function(l,r,a){var m=b("#myatu_bgm_top"),q=b("#myatu_bgm_prev"),t=q.offset(),p={top:m.css("top"),left:m.css("left")},o,s,n;switch(l){case"top":s="top";o="-"+(m.height()-t.top)+"px";break;case"bottom":s="top";o=(q.height()+t.top)+"px";break;case"left":s="left";o="-"+(m.width()-t.left)+"px";break;case"right":s="left";o=(q.width()+t.left)+"px";break}m.css(s,o);m.show();if(typeof a==="undefined"||a===false){m.animate(p,{duration:r,complete:myatu_bgm.onAnimationCompleted,step:function(d,c){if(c.prop===s){switch(l){case"top":q.css(s,(m.height()+d)+"px");break;case"bottom":q.css(s,(d-q.height())+"px");break;case"left":q.css(s,(m.width()+d)+"px");break;case"right":q.css(s,(d-q.width())+"px");break}}}})}else{m.animate(p,{duration:r,complete:myatu_bgm.onAnimationCompleted})}},adjustImageSize:function(t){var p=(myatu_bgm.fs_center==="true"),r={left:0,top:0},u=b(t).naturalWidth(),a=b(t).naturalHeight(),o=u/a,m=window.innerHeight||b(window).height(),s=window.innerWidth||b(window).width(),q=s,v=q/o,n;if(myatu_bgm.is_fullsize!=="true"){return false}if(v>=m){n=(v-m)/2;if(p){b.extend(r,{top:"-"+n+"px"})}}else{v=m;q=v*o;n=(q-s)/2;if(p){b.extend(r,{left:"-"+n+"px"})}}b(t).width(q).height(v).css(r);return true},loadImage:function(a,d){if(myatu_bgm.image_holder===null){myatu_bgm.image_holder=b("<img />")}myatu_bgm.image_holder.attr("src",a).imgLoaded(function(){myatu_bgm.adjustImageSize(this);if(typeof d==="function"){d()}})},onWindowResize:function(d){var a=myatu_bgm.image_holder;if(a===null){return}myatu_bgm.adjustImageSize(a);b("div#myatu_bgm_top").css("background-size",a.width()+"px "+a.height()+"px");b("#myatu_bgm_top").css({left:a.css("left"),top:a.css("top"),width:a.width()+"px",height:a.height()+"px"})},isMobile:function(){var a=(navigator.userAgent||navigator.vendor||window.opera);return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))},isDisabled:function(){var a=(myatu_bgm.display_on_mobile==="true");return(myatu_bgm.isMobile()&&!a)},addTopImage:function(k,h){var l,i=myatu_bgm.current_background.url,j=myatu_bgm.current_background.alt,a={display:"none"};if(myatu_bgm.isDisabled()){return}myatu_bgm.loadImage(i,function(){if(myatu_bgm.Modernizr.backgroundsize){l=b("<div></div>");b.extend(a,{"background-image":"url("+i+")","background-size":myatu_bgm.image_holder.width()+"px "+myatu_bgm.image_holder.height()+"px","background-repeat":"no-repeat"})}else{l=myatu_bgm.image_holder.clone();l.attr("alt",j)}b.extend(a,{left:myatu_bgm.image_holder.css("left"),top:myatu_bgm.image_holder.css("top"),width:myatu_bgm.image_holder.width()+"px",height:myatu_bgm.image_holder.height()+"px"});l.attr({id:"myatu_bgm_top","class":"myatu_bgm_fs",style:k}).css(a).appendTo("#myatu_bgm_img_group");myatu_bgm.doGAEvent("Display");if(typeof h==="function"){h.call(l)}})},switchBackground:function(p){var m=(myatu_bgm.is_fullsize==="true"),o=(myatu_bgm.is_preview==="true"),k=b("#myatu_bgm_info_tab"),a=false,n,l,q,r;if(myatu_bgm.timer){clearTimeout(myatu_bgm.timer)}if((m&&!b("#myatu_bgm_top").is(":visible"))){myatu_bgm.setTimer();return}b(document).trigger("myatu_bgm_switch_background");if(o){q=myatu_bgm.image_selection}p=p||false;if(p){q=p}myatu_bgm.GetAjaxData("select_image",{prev_img:myatu_bgm.current_background.url,selector:q,active_gallery:myatu_bgm.active_gallery},function(c){if(!c||c.url===myatu_bgm.current_background.url){return}myatu_bgm.previous_background=myatu_bgm.current_background;myatu_bgm.current_background=b.extend(myatu_bgm.current_background,c);if(m){if(o){n=Number(myatu_bgm.transition_speed);l=myatu_bgm.active_transition;if(l==="random"){l=myatu_bgm.transitions[Math.floor(Math.random()*myatu_bgm.transitions.length)]}}else{n=c.transition_speed;l=c.transition}b("#myatu_bgm_top").attr("id","myatu_bgm_prev");myatu_bgm.addTopImage(b("#myatu_bgm_prev").attr("style"),function(){if(myatu_bgm.Modernizr.backgroundsize){if(typeof r==="undefined"){r=new myatu_bgm_flux.slider("#myatu_bgm_img_group",{pagination:false,autoplay:false});b("#myatu_bgm_img_group").bind("fluxTransitionEnd",myatu_bgm.onAnimationCompleted)}}else{if(l!=="none"&&b.inArray(l,myatu_bgm.flux_transitions)>-1){l=""}}if(b.inArray(l,myatu_bgm.flux_transitions)>-1){n=n/50}b.extend(myatu_bgm.current_background,{transition:l,transition_speed:n});b(document).trigger("myatu_bgm_start_transition",[l,n,myatu_bgm.current_background]);switch(l){case"none":b(this).show();myatu_bgm.onAnimationCompleted();break;case"coverdown":a=true;case"slidedown":myatu_bgm.animateSlide("top",n,a);break;case"coverup":a=true;case"slideup":myatu_bgm.animateSlide("bottom",n,a);break;case"coverright":a=true;case"slideright":myatu_bgm.animateSlide("left",n,a);break;case"coverleft":a=true;case"slideleft":myatu_bgm.animateSlide("right",n,a);break;case"bars":case"blinds":case"zip":case"blocks":r.next(l,{delayBetweenBars:n});break;case"blocks2":r.next("blocks2",{delayBetweenDiagnols:n});break;case"concentric":case"warp":r.next(l,{delay:n*2});break;case"swipe":r.next(l);break;case"zoom":b("#myatu_bgm_prev").animate({opacity:0},{duration:n,queue:false});b(this).animate({width:b(this).width()*1.05,height:b(this).height()*1.05,opacity:"show"},{duration:n,complete:myatu_bgm.onAnimationCompleted});break;default:b("#myatu_bgm_prev").animate({opacity:0},{duration:n,queue:false});b(this).fadeIn(n,myatu_bgm.onAnimationCompleted);break}})}else{b("body").attr("style",'background-image: url("'+c.url+'") !important');myatu_bgm.setTimer()}myatu_bgm.setBackgroundLink();if(k.length){if(b.isFunction(k.qtip)){k.qtip("api").hide()}}if(b("#myatu_bgm_pin_it_btn").length){var e=b("#myatu_bgm_pin_it_btn a"),d=e.attr("href"),f=c.desc.replace(/(<([^>]+)>)/ig,"");d=myatu_bgm.urlReplaceQueryArgVal(d,"media",c.url);d=myatu_bgm.urlReplaceQueryArgVal(d,"description",f);e.attr("href",d)}})},initInfoTab:function(){var a=b("#myatu_bgm_info_tab");if(!b.isFunction(a.qtip)||!a.length){return}a.qtip({content:{text:function(h){var i=b("<img />").attr({src:myatu_bgm.current_background.thumb,alt:myatu_bgm.current_background.alt}),j=b("<div></div>").addClass("myatu_bgm_info_tab_content"),g=myatu_bgm.current_background.desc;if(myatu_bgm.info_tab_thumb==="true"){j.append(i)}if(g){i.css({width:"100px",height:"100px"});j.append(g)}else{i.css("margin","5px 0")}return j},title:{text:function(d){return myatu_bgm.current_background.caption},button:true}},style:{classes:"ui-tooltip-bootstrap ui-tooltip-shadow ui-tooltip-rounded"},hide:false,position:{adjust:{x:-10},viewport:b(window)}})}});b(document).ready(function(f){var a=f("#myatu_bgm_bg_link"),e;if(myatu_bgm.isDisabled()){f("body").removeClass("myatu_bgm_body");f(".pin-it-button").hide();f("#myatu_bgm_info").hide();f("#myatu_bgm_overlay").hide();return}if(a.length){myatu_bgm.setBackgroundLink();a.remove()}f(window).resize(myatu_bgm.onWindowResize);myatu_bgm.initInfoTab();myatu_bgm.setTimer()})}(jQuery));