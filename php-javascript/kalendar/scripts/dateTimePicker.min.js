"use strict";!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b="calendar",c="plugin_"+b,d={modifier:"datetimepicker",day_name:["Su","Mo","Tu","We","Th","Fr","Sa"],day_first:0,month_name:["January","February","March","April","May","June","July","August","September","October","November","December"],paging:['<i class="prev"></i>','<i class="next"></i>'],unavailable:[],adapter:null,month:null,year:null,num_next_month:0,num_prev_month:0,num_of_week:6,onSelectDate:function(){}},e=function(b){var c=new Date;return this.options=b,this.$element=a(b.element),this.options.year=this.$element.data("year")||this.options.year||c.getFullYear(),this.options.month=this.$element.data("month")||this.options.month||c.getMonth()+1,this.options.month--,this.unavailable=[],this.init.call(this),this};e.prototype={init:function(){this.day_index=[],this.options.day_name=this.options.day_name.slice(this.options.day_first).concat(this.options.day_name.slice(0,this.options.day_first));for(var a=0;a<this.options.day_name.length;a++)this.day_index.push((this.options.day_first+a+7)%7);this.update()},update:function(){var b=this,c=this.getMonths();"string"==typeof this.options.adapter?a.getJSON(this.options.adapter,{keys:a(c).map(function(){return this.year+"-"+(this.month<=8?"0":"")+(this.month+1)}).toArray()},function(a){b.unavailable=b.options.unavailable.concat(a),b.draw(c)}):(this.unavailable=this.options.unavailable,this.draw(c))},draw:function(a){this.$element.empty();for(var b in a)this.$element.append(this.getCalendar(a[b].month,a[b].year))},getMonths:function(){for(var a=new Date,b=[],c=this.options.month-this.options.num_prev_month;c<=this.options.month+this.options.num_next_month;c++)a.setFullYear(this.options.year),a.setMonth(c),b.push({month:a.getMonth(),year:a.getFullYear()});return b},prevMonth:function(){this.options.month--,this.update()},nextMonth:function(){this.options.month++,this.update()},getCalendar:function(b,c){var d=this,e=new Date;e.setFullYear(c),e.setMonth(b),e.setDate(1);var f=e.getDay();e.setMonth(e.getMonth()+1),e.setDate(0);var g,h=e.getDate(),i=this.day_index.indexOf(f);return g=isNaN(this.options.num_of_week)?Math.ceil((i+h)/7):6,a("<div>").addClass(this.options.modifier).append([a("<div>").addClass("paging").append(function(){return[a("<span>").addClass("prev").append(d.options.paging[0]).click(function(){d.prevMonth()}),a("<div>").addClass("month-name").append([d.options.month_name[e.getMonth()],", ",e.getFullYear()]),a("<span>").addClass("next").append(d.options.paging[1]).click(function(){d.nextMonth()})]}),a("<table>").append(function(){return[a("<thead>").append(function(){return a(d.options.day_name).map(function(b,c){return a("<td>").append(c)}).toArray()}),a("<tbody>").append(function(){for(var f=[],h=0;g>h;h++)f.push(a("<tr>").append(function(){for(var f=[],g=0;7>g;g++){var j=new Date;j.setFullYear(c),j.setMonth(b),j.setDate(-i+(g+1)+7*h),f.push(a("<td>").addClass(function(){var a=[];return a.push(d.isAvailable(j.getDate(),j.getMonth()+1,j.getFullYear())?"available":"unavailable"),a.push(j.getMonth()==e.getMonth()?"cur-month":"near-month"),a.join(" ")}).data({date:j.getDate(),month:j.getMonth()+1,year:j.getFullYear()}).append(j.getDate()).click(function(){var b=a(this).data("date"),c=a(this).data("month"),e=a(this).data("year");d.options.onSelectDate.call(d,b,c,e)}))}return f}));return f})]})])},isAvailable:function(a,b,c){for(var d in this.unavailable){var e=this.unavailable[d].split("-");if(3!==e.length)return!1;if(!("*"!=e[0]&&e[0]-c!==0||"*"!=e[1]&&e[1]-b!==0||"*"!=e[2]&&e[2]-a!==0))return!1}return!0}},a.fn[b]=function(b){return this.each(function(){var f=a(this).data(c);f||a(this).data(c,new e(a.extend({element:this},d,b))),"string"==typeof b&&a(this).data(c)[b].call(this)})}});